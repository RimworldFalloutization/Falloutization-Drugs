<?xml version="1.0" encoding="utf-8"?>
<Patch>
  <!-- Remove Drug Production research project -->
  <Operation Class="PatchOperationRemove">
    <xpath>Defs/ResearchProjectDef[defName='DrugProduction']</xpath>
  </Operation>

  <!-- Remove Drug Production prerequisite from Drug Lab -->
  <Operation Class="PatchOperationRemove">
    <xpath>Defs/ThingDef[defName='DrugLab']/researchPrerequisites/li[.='DrugProduction']</xpath>
  </Operation>

  <!-- Remove Drug Production prerequisite from VFE Electric Drug Lab -->
  <Operation Class="PatchOperationRemove" MayRequire="VanillaExpanded.VFEProduction">
    <xpath>Defs/ThingDef[defName='VFE_TableDrugLabElectric']/researchPrerequisites/li[.='DrugProduction']</xpath>
  </Operation>

  <!-- Remove Drug Production prerequisite from FCP Chem Production -->
  <Operation Class="PatchOperationRemove" MayRequire="Rick.FCP.Core.Tools">
    <xpath>Defs/ResearchProjectDef[defName='FCP_Research_Chem_Production']/prerequisites/li[.='DrugProduction']</xpath>
  </Operation>

  <!-- Replace Drug Production prerequisite for Medicine Production with FCP Medicinal Drugs -->
  <Operation Class="PatchOperationReplace" MayRequire="Rick.FCP.Core.Tools">
    <xpath>Defs/ResearchProjectDef[defName='MedicineProduction']/prerequisites/li[.='DrugProduction']</xpath>
    <value>
      <li>FCP_Research_Medicinal_Drugs</li>
    </value>
  </Operation>

  <!-- Move vanilla industrial medicine crafting to FCP Chemistry Workbench -->
  <Operation Class="PatchOperationReplace" MayRequire="Rick.FCP.Core.Tools">
    <xpath>Defs/ThingDef[defName='MedicineIndustrial']/recipeMaker/recipeUsers</xpath>
    <value>
      <recipeUsers>
        <li>FCP_Production_Chemistry_Workbench</li>
      </recipeUsers>
    </value>
  </Operation>

  <!-- Make Chemistry Workbench like being in a Laboratory room -->
  <Operation Class="PatchOperationAdd" MayRequire="Rick.FCP.Core.Tools">
    <xpath>Defs/ThingDef[defName='FCP_Production_Chemistry_Workbench']/building</xpath>
    <value>
      <workTableRoomRole>Laboratory</workTableRoomRole>
      <workTableNotInRoomRoleFactor>0.8</workTableNotInRoomRoleFactor>
    </value>
  </Operation>

  <!-- Make VFE Drug Cabinet boost FCP Chemistry Workbench -->
  <Operation Class="PatchOperationAdd" MayRequire="VanillaExpanded.VFEProduction">
    <xpath>Defs/ThingDef[defName='FCP_Production_Chemistry_Workbench']/comps/li[@Class='CompProperties_AffectedByFacilities']/linkableFacilities</xpath>
    <value>
      <li>VFE_DrugCabinet</li>
    </value>
  </Operation>

  <!-- Make Drug Lab unbuildable -->
  <Operation Class="PatchOperationReplace" MayRequire="Rick.FCP.Core.Tools">
    <xpath>Defs/ThingDef[defName='DrugLab']/designationCategory</xpath>
    <value>
      <designationCategory IsNull="True"/>
    </value>
  </Operation>

  <Operation Class="PatchOperationAdd" MayRequire="Rick.FCP.Core.Tools">
    <xpath>Defs/ThingDef[defName='DrugLab']/building</xpath>
    <value>
      <neverBuildable>true</neverBuildable>
    </value>
  </Operation>

  <!-- Make Electric Drug Lab unbuildable -->
  <Operation Class="PatchOperationReplace" MayRequire="VanillaExpanded.VFEProduction">
    <xpath>Defs/ThingDef[defName='VFE_TableDrugLabElectric']/designationCategory</xpath>
    <value>
      <designationCategory IsNull="True"/>
    </value>
  </Operation>

  <Operation Class="PatchOperationAdd" MayRequire="VanillaExpanded.VFEProduction">
    <xpath>Defs/ThingDef[defName='VFE_TableDrugLabElectric']/building</xpath>
    <value>
      <neverBuildable>true</neverBuildable>
    </value>
  </Operation>
</Patch>
